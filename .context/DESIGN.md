# Visual Knowledge Deconstructor — 设计文档

## 愿景

一个 Web 应用，帮助用户在阅读中遇到晦涩内容时，通过大模型自动拆解概念，以可交互的思维导图方式逐层展开大白话解释。替代传统的「逐个搜索再拼凑」的低效学习方式，让知识理解变得连贯、直观、可递归深入。

## 问题陈述

阅读时经常遇到一段话中包含多个不认识的概念、专业名词或复杂关系。当前的做法是逐个复制概念去搜索，再汇集起来重新理解，这个过程碎片化且低效。需要一个工具能一站式完成「概念识别 → 逐层解释 → 递归深入」的完整流程。

## 目标用户

- 非专业领域的学习者（在阅读跨领域内容时遇到理解障碍）
- 学生（阅读教材、论文时需要快速理解专业概念）
- 任何对新领域知识感到陌生、需要快速入门的人

## 核心功能

### P0 — 必须有

- **文本输入**：用户通过复制粘贴输入一段文字
- **概念抽取**：大模型以新手视角分析文本，自动识别晦涩难懂的概念和专业名词
- **概念勾选**：展示抽取出的概念列表，用户可勾选想深入了解的概念
- **思维导图生成**：基于 React Flow 生成可交互的节点图，用大白话解释每个概念
- **递归展开**：点击任意节点可继续调用大模型，衍生出更深层的解释分支
- **画布交互**：节点可拖拽、画布可缩放平移

### P1 — 应该有

- **加载状态**：概念抽取和解释生成过程中的 loading/streaming 反馈
- **错误处理**：API 调用失败时的友好提示和重试机制
- **响应式布局**：移动端基本可用

### P2 — 最好有

- **导出功能**：思维导图导出为图片或 Markdown
- **历史记录**：localStorage 保存最近的解构记录
- **多语言输入**：支持英文等其他语言文本的输入和解释
- **主题切换**：亮色/暗色模式

## 技术决策

- **框架**：Next.js (App Router) + React 19 + TypeScript
- **可视化**：React Flow (@xyflow/react) — 自由布局节点图，支持拖拽、缩放、连线
- **样式**：Tailwind CSS 4 + shadcn/ui + Radix UI
- **状态管理**：Jotai — 轻量原子化状态，适合管理节点数据和 UI 状态
- **AI 调用**：Vercel AI SDK，通过 Next.js API Routes 代理请求
- **大模型**：智谱 GLM-4（兼容 Anthropic API 格式）
  - Base URL: `https://open.bigmodel.cn/api/anthropic`
  - Model: `glm-4.7`
- **API Key 管理**：服务端环境变量（`ANTHROPIC_API_KEY`），不暴露给前端
- **部署方式**：Vercel（与 Next.js 天然契合）

## 核心交互流程

```
用户粘贴文本
    ↓
[API] 大模型抽取概念列表
    ↓
展示概念列表（带 checkbox）
    ↓
用户勾选 → 点击「开始解构」
    ↓
[API] 大模型为每个概念生成大白话解释
    ↓
React Flow 渲染思维导图
    ↓
用户点击某个节点
    ↓
[API] 大模型递归生成该节点的子概念解释
    ↓
思维导图动态扩展新分支
```

## 非目标

- 不做用户账号/登录系统
- 不做数据库持久化存储
- 不做浏览器插件版本
- 不做多语言 UI（界面语言）
- 不做协作/分享功能
- 不做 PDF/网页直接导入（仅支持复制粘贴文本）

## 成功标准

1. 用户能在 3 步内完成一次知识解构：粘贴 → 勾选 → 查看导图
2. 概念解释准确且通俗易懂（"小白能看懂"）
3. 递归展开交互流畅，无需跳出应用
4. 思维导图布局清晰，节点不重叠，连线不交叉
